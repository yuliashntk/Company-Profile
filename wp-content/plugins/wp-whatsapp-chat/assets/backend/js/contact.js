!function(t){var e={};function a(i){if(e[i])return e[i].exports;var n=e[i]={i:i,l:!1,exports:{}};return t[i].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=t,a.c=e,a.d=function(t,e,i){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},a.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(a.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)a.d(i,n,function(e){return t[e]}.bind(null,n));return i},a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="",a(a.s=1)}([function(t,e){!function(){t.exports=this.jQuery}()},function(t,e,a){"use strict";a.r(e);a(2);var i=a(0),n=a.n(i);a(3);!function(t){var e,a=0,i=function(){t("#qlwapp_modal").removeClass("processing")};_.mixin({escapeHtml:function(t){return t.replace("&amp;",/&/g).replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&quot;/g,'"').replace(/&#039;/g,"'")}});var n=Backbone.Model.extend({defaults:qlwapp_contact.args}),s=Backbone.View.extend({templates:{},initialize:function(t){this.templates.window=wp.template(t.subview)},render:function(){return this.$el.html(this.templates.window(this.attributes)),this}}),o=Backbone.View.extend({templates:{},initialize:function(t){this.templates.window=wp.template(t.subview)},render:function(){return this.$el.html(this.templates.window(this.attributes)),this}}),l=Backbone.View.extend({templates:{},initialize:function(t){this.templates.window=wp.template(t.subview)},render:function(){return this.$el.html(this.templates.window(this.attributes)),this}}),r=Backbone.View.extend({templates:{},initialize:function(t){this.templates.window=wp.template(t.subview)},render:function(){return this.$el.html(this.templates.window(this.attributes)),this}}),c=Backbone.View.extend({templates:{},initialize:function(t){this.templates.window=wp.template(t.subview)},render:function(){return this.$el.html(this.templates.window(this.attributes)),this}}),d=Backbone.View.extend({templates:{},initialize:function(t){this.templates.window=wp.template(t.subview)},render:function(){return this.$el.html(this.templates.window(this.attributes)),this}}),u=Backbone.View.extend({templates:{},initialize:function(t){this.templates.window=wp.template(t.subview)},render:function(){return this.$el.html(this.templates.window(this.attributes)),this}}),p=(Backbone.View.extend({templates:{},initialize:function(t){this.templates.window=wp.template(t.subview)},render:function(){return this.$el.html(this.templates.window(this.attributes)),this}}),Backbone.View.extend({events:{"change input":"enable","change textarea":"enable","change select":"enable","click .media-modal-backdrop":"close","click .media-modal-close":"close","click .media-modal-prev":"edit","click .media-modal-next":"edit","change .media-modal-change":"change","change .media-modal-subview":"subview","submit .media-modal-form":"submit"},templates:{},initialize:function(){_.bindAll(this,"open","edit","change","subview","load","render","close","submit"),this.init(),this.open()},init:function(){this.templates.window=wp.template("qlwapp-modal-window")},LoadTemplate1:function(t){return Backbone.View.extend({templates:{},initialize:function(t){this.templates.window=wp.template(t.subview)},render:function(){return this.$el.html(this.templates.window(this.attributes)),this}})},assign:function(t,e){t.setElement(this.$(e)).render()},render:function(){var t=this,e=this.$el.find("ul.wc-tabs li.active a").attr("href");t.$el.html(t.templates.window(t.model.attributes)),this.header=new s({subview:"subview-header",attributes:t.model.attributes}),this.footer=new o({subview:"subview-footer",attributes:t.model.attributes}),this.tabs=new l({subview:"subview-tabs",attributes:t.model.attributes}),this.contact=new r({subview:"subview-contact",attributes:t.model.attributes}),this.contact_chat=new c({subview:"subview-contact-chat",attributes:t.model.attributes}),this.info=new u({subview:"subview-contact-info",attributes:t.model.attributes}),this.visibility=new d({subview:"subview-visibility",attributes:t.model.attributes}),this.assign(this.header,"#panel-header"),this.assign(this.footer,"#panel-footer"),this.assign(this.tabs,"#panel-tabs"),this.assign(this.contact,"#panel-contact"),this.assign(this.contact_chat,"#subpanel-contact-chat"),this.assign(this.info,"#panel-info"),this.assign(this.visibility,"#panel-visibility"),_.delay((function(){t.$el.trigger("qlwapp-enhanced-select"),t.$el.trigger("qlwapp-tab-panels",e)}),100)},load:function(){var e=this;t("#qlwapp_modal").addClass("processing"),t.ajax({url:ajaxurl,data:{action:"qlwapp_edit_contact",nonce:qlwapp_contact.nonce.qlwapp_edit_contact,contact_id:this.model.attributes.id},dataType:"json",type:"POST",beforeSend:function(){},complete:function(){i()},error:function(){alert("Error!")},success:function(t){t.success?(e.model.set(t.data),e.render()):alert(t.data)}})},edit:function(i){i.preventDefault();var n=this,s=t(i.target),o=parseInt(t("#qlwapp_contacts_table tr[data-contact_id]").length),l=parseInt(n.model.get("order"));a++,e&&clearTimeout(e),e=setTimeout((function(){l=s.hasClass("media-modal-next")?Math.min(l+a,o):Math.max(l-a,1),n.model.set({id:parseInt(t("#qlwapp_contacts_table tr[data-contact_position="+l+"]").data("contact_id"))}),a=0,n.load()}),300)},open:function(e){t("body").addClass("modal-open").append(this.$el),null!=this.model.attributes.id?this.load():_.delay((function(){i()}),100)},update:function(e){e.preventDefault();var a=t(e.target),i=a.attr("name"),n=a.val();"checkbox"===e.target.type&&(n=!0===a.prop("checked")?1:0),this.model.attributes[i]=n,this.model.changed[i]=n},change:function(t){t.preventDefault(),this.update(t)},subview:function(t){this.contact_chat.render()},reload:function(t){this.$el.find("#qlwapp_modal").hasClass("reload")?location.reload():this.remove()},close:function(e){e.preventDefault(),this.undelegateEvents(),t(document).off("focusin"),this.$el.find("#qlwapp_modal").addClass("reload"),this.reload(e)},enable:function(e){t(".media-modal-submit").prop("disabled",!1)},submit:function(e){e.preventDefault();var a=this,i=a.$el.find("#qlwapp_modal"),n=i.find(".attachment-details");return console.log(t("form",this.$el).serializeArray()),t.ajax({url:ajaxurl,data:{action:"qlwapp_save_contact",nonce:qlwapp_contact.nonce.qlwapp_save_contact,contact_id:a.model.attributes.id,contact_data:t("form",this.$el).serialize()},dataType:"json",type:"POST",beforeSend:function(){t(".media-modal-submit").prop("disabled",!0),n.addClass("save-waiting")},complete:function(){n.addClass("save-complete"),n.removeClass("save-waiting")},error:function(){alert("Error!")},success:function(t){t.success?null==a.model.attributes.id&&(i.addClass("reload"),a.reload(e),a.close(e)):alert(t.data)}}),!1}})),f=Backbone.View.extend({initialize:function(e){var a=t(e.target).closest("[data-contact_id]").data("contact_id"),i=new n;i.set({id:a}),new p({model:i}).render()}}),m=!1;t(".qlwapp_settings_edit").on("click",(function(t){t.preventDefault(),m||(new f(t),m=!0)})),t("#qlwapp_contact_add").on("click",(function(t){t.preventDefault(),new f(t)})),t(".qlwapp_settings_delete").on("click",(function(e){e.preventDefault();var a=t("#qlwapp_delete_contact_nonce").val(),i=t(e.target).closest("[data-contact_id]").data("contact_id");if(!confirm(qlwapp_contact.message.contact_confirm_delete))return!1;t.ajax({url:ajaxurl,data:{action:"qlwapp_delete_contact",nonce:a,contact_id:i},dataType:"json",type:"POST",beforeSend:function(){},complete:function(){},error:function(t){console.log(t)},success:function(t){t.data?location.reload():alert(t.data)}})})),t("table#qlwapp_contacts_table tbody").sortable({items:"tr",cursor:"move",axis:"y",handle:"td.sort",scrollSensitivity:40,helper:function(e,a){return a.children().each((function(){t(this).width(t(this).width())})),a.css("left","0"),a},start:function(t,e){e.item.css("background-color","#f6f6f6")},stop:function(t,e){e.item.removeAttr("style"),e.item.trigger("updateMoveButtons"),e.item.trigger("updateSaveButton")}}),t(document).on("updateSaveButton",(function(){t("#qlwapp_contact_order").prop("disabled",!1)})),t(".wc-item-reorder-nav").find(".wc-move-up, .wc-move-down").on("click",(function(){var e=t(this),a=e.closest("tr");e.focus();var i=e.is(".wc-move-up"),n=e.is(".wc-move-down");if(i){var s=a.prev("tr");s&&s.length&&s.before(a)}else if(n){var o=a.next("tr");o&&o.length&&o.after(a)}e.focus(),e.closest("table").trigger("updateMoveButtons"),e.closest("table").trigger("updateSaveButton")})),t(".wc-item-reorder-nav").closest("table").on("updateMoveButtons",(function(){var e=t(this),a=t(this).find("tbody tr:last"),i=t(this).find("tbody tr:first");e.find(".wc-item-reorder-nav .wc-move-disabled").removeClass("wc-move-disabled").attr({tabindex:"0","aria-hidden":"false"}),i.find(".wc-item-reorder-nav .wc-move-up").addClass("wc-move-disabled").attr({tabindex:"-1","aria-hidden":"true"}),a.find(".wc-item-reorder-nav .wc-move-down").addClass("wc-move-disabled").attr({tabindex:"-1","aria-hidden":"true"})})),t("table#qlwapp_contacts_table tbody").trigger("updateMoveButtons"),t(document).on("submit","#qlwapp_contacts_form",(function(e){e.preventDefault();var a=t(this),i=a.find(".settings-save-status .spinner"),n=a.find(".settings-save-status .saved");return t.ajax({url:ajaxurl,data:{action:"qlwapp_save_contact_order",nonce:qlwapp_contact.nonce.qlwapp_save_contact_order,contact_data:a.serialize()},dataType:"json",type:"POST",beforeSend:function(){i.addClass("is-active")},complete:function(){i.removeClass("is-active")},error:function(t){console.log(t)},success:function(e){n.addClass("is-active"),t("#qlwapp_contact_order").prop("disabled",!0),e.success?setTimeout((function(){n.removeClass("is-active")}),1500):alert(e.data)}}),!1})),t(document).on("qlwapp-tab-panels",(function(e,a){var i=t(e.target).find("ul.qlwapp-tabs"),n=i.find('a[href="'+a+'"]');i.show(),i.find("a").click((function(e){e.preventDefault();var a=t(this).closest("div.panel-wrap");i.find("li",a).removeClass("active"),t(this).parent().addClass("active"),t("div.panel",a).hide(),t(t(this).attr("href")).show()})),n.length&&t(n.attr("href")).length?n.click():i.find("li.active").find("a").click()}))}(n.a)},function(t,e){!function(){t.exports=this.wp.util}()},function(t,e){!function(){t.exports=this.window.Backbone}()}]);